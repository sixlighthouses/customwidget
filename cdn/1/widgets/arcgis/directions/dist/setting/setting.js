System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/utility-selector"],(function(e,t){var i={},o={},n={},s={};return{setters:[function(e){i.DataSourceTypes=e.DataSourceTypes,i.Immutable=e.Immutable,i.React=e.React,i.SupportedUtilityType=e.SupportedUtilityType,i.classNames=e.classNames,i.css=e.css,i.dataSourceUtils=e.dataSourceUtils,i.hooks=e.hooks,i.jsx=e.jsx,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,i.lodash=e.lodash,i.polished=e.polished},function(e){o.defaultMessages=e.defaultMessages},function(e){n.MapWidgetSelector=e.MapWidgetSelector,n.SearchDataSetting=e.SearchDataSetting,n.SearchDataType=e.SearchDataType,n.SearchGeneralSetting=e.SearchGeneralSetting,n.SearchSuggestionSetting=e.SearchSuggestionSetting,n.SettingRow=e.SettingRow,n.SettingSection=e.SettingSection},function(e){s.UtilitySelector=e.UtilitySelector}],execute:function(){e((()=>{var e={748:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.501 3.501 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},48891:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=o},77756:e=>{"use strict";e.exports=n},52785:e=>{"use strict";e.exports=s}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var l={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(l),r.d(l,{__set_webpack_public_path__:()=>I,default:()=>x});var e=r(48891),t=r(30726),i=r(77756),o=r(52785),n=r(748),s=r.n(n);const a=t=>{const i=window.SVG,{className:o}=t,n=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(i[o[n]]=e[o[n]])}return i}(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:r,src:s()},n)):e.React.createElement("svg",Object.assign({className:r},n))},u={routeSettings:"Route Settings",searchSettings:"Search settings",routeUrl:"Route URL",outputStops:"Stops",outputRoute:"Route",outputDirectionPoints:"Direction points",outputDirectionLines:"Direction lines"};function c(e){return`${e}_output_stop`}function d(e){return`${e}_output_direction_point`}function p(e){return`${e}_output_direction_line`}function g(e){return`${e}_output_route`}function f(t){if(!t)return null;const i={};return t.forEach((t=>{i[t.name]=e.dataSourceUtils.convertFieldToJimuField(t,null)})),i}var v=function(e,t,i,o){return new(i||(i=Promise))((function(n,s){function r(e){try{a(o.next(e))}catch(e){s(e)}}function l(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};const{useMemo:m,useEffect:y}=e.React,S={maxSuggestions:6},h=[e.SupportedUtilityType.Routing],x=n=>{var s,r,l;const{onSettingChange:x,id:I,config:w,useMapWidgetIds:D,useUtilities:O,portalUrl:U}=n,C=e.hooks.useTranslation(u,t.defaultMessages),_=null==w?void 0:w.routeConfig,T=null===(s=w.searchConfig)||void 0===s?void 0:s.dataConfig,M=null===(r=w.searchConfig)||void 0===r?void 0:r.generalConfig,R=m((()=>{var t;return(0,e.Immutable)(S).merge((null===(t=w.searchConfig)||void 0===t?void 0:t.suggestionConfig)||{})}),[null===(l=w.searchConfig)||void 0===l?void 0:l.suggestionConfig]),P=m((()=>(null==D?void 0:D.length)>0),[D]),F=`${I}-desc`;return y((()=>{var t;const i=T&&function(e,t){return e.filter((e=>t.some((t=>t.utilityId===e.useUtility.utilityId))))}(T,O),o=_&&function(e,t){return e&&e.useUtility&&t.some((t=>t.utilityId===e.useUtility.utilityId))?e:null}(_,O);e.lodash.isDeepEqual(i,T)&&e.lodash.isDeepEqual(o,_)||x({id:I,config:w.setIn(["searchConfig","dataConfig"],i).setIn(["routeConfig"],o),useUtilities:j(null==o?void 0:o.useUtility,null===(t=null==i?void 0:i.map((e=>e.useUtility)))||void 0===t?void 0:t.asMutable())})}),[w,I,x,_,T,O]),(0,e.jsx)("div",{className:"widget-setting-directions jimu-widget-setting",css:b},(0,e.jsx)(i.SettingSection,{title:C("selectMapWidget"),className:(0,e.classNames)({"border-0":!P})},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(i.MapWidgetSelector,{onSelect:t=>v(void 0,void 0,void 0,(function*(){const i=yield function(t,i,o){var n,s,r,l;return v(this,void 0,void 0,(function*(){if(!i||0===i.length)return Promise.resolve([]);try{const[i,a,u,v]=yield(0,e.loadArcGISJSAPIModules)(["esri/rest/support/Stop","esri/rest/support/DirectionPoint","esri/rest/support/DirectionLine","esri/rest/support/RouteInfo"]);return[{id:c(t),label:o("outputStops"),type:e.DataSourceTypes.FeatureLayer,isOutputFromWidget:!0,geometryType:"esriGeometryPoint",schema:{idField:(null===(n=i.fields.find((e=>"esriFieldTypeOID"===e.type)))||void 0===n?void 0:n.name)||"__OBJECTID",fields:Object.assign({},f(i.fields))}},{id:d(t),label:o("outputDirectionPoints"),type:e.DataSourceTypes.FeatureLayer,isOutputFromWidget:!0,geometryType:"esriGeometryPoint",schema:{idField:(null===(s=a.fields.find((e=>"esriFieldTypeOID"===e.type)))||void 0===s?void 0:s.name)||"__OBJECTID",fields:Object.assign({},f(a.fields))}},{id:p(t),label:o("outputDirectionLines"),type:e.DataSourceTypes.FeatureLayer,isOutputFromWidget:!0,geometryType:"esriGeometryPolyline",schema:{idField:(null===(r=u.fields.find((e=>"esriFieldTypeOID"===e.type)))||void 0===r?void 0:r.name)||"__OBJECTID",fields:Object.assign({},f(u.fields))}},{id:g(t),label:o("outputRoute"),type:e.DataSourceTypes.FeatureLayer,isOutputFromWidget:!0,geometryType:"esriGeometryPolyline",schema:{idField:(null===(l=v.fields.find((e=>"esriFieldTypeOID"===e.type)))||void 0===l?void 0:l.name)||"__OBJECTID",fields:Object.assign({},f(v.fields))}}]}catch(e){return console.warn("Failed to create output data source in directions widget. ",e),Promise.resolve([])}}))}(I,t,C);x({id:I,useMapWidgetIds:t},i)})),useMapWidgetIds:D}))),P?(0,e.jsx)("div",null,(0,e.jsx)(i.SettingSection,{role:"group","aria-label":C("routeSettings"),title:C("routeSettings")},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:C("routeUrl")},(0,e.jsx)(o.UtilitySelector,{useUtilities:(0,e.Immutable)((null==_?void 0:_.useUtility)&&(null==O?void 0:O.some((e=>_.useUtility.utilityId===e.utilityId)))?[_.useUtility]:[]),onChange:e=>{var t,i,o,n,s;(null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.utilityId)!==(null===(i=null==_?void 0:_.useUtility)||void 0===i?void 0:i.utilityId)&&x({id:I,config:w.setIn(["routeConfig","useUtility"],null==e?void 0:e[0]),useUtilities:j(null==e?void 0:e[0],null===(s=null===(n=null===(o=w.searchConfig)||void 0===o?void 0:o.dataConfig)||void 0===n?void 0:n.map((e=>e.useUtility)))||void 0===s?void 0:s.asMutable())})},showRemove:!0,closePopupOnSelect:!0,types:h,"aria-describedby":F})),(0,e.jsx)(i.SettingRow,{className:"mt-0"},(0,e.jsx)("i",{className:"text-break example-url",id:F},C("exampleUrl",{url:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World"})))),(0,e.jsx)(i.SettingSection,{role:"group","aria-label":C("searchSettings"),title:C("searchSettings"),className:"search-settings"},(0,e.jsx)(i.SearchDataSetting,{id:I,datasourceConfig:T,createOutputDs:!1,portalUrl:U,hideIconSetting:!0,searchDataSettingType:i.SearchDataType.GeocodeService,onSettingChange:t=>{var i;e.lodash.isDeepEqual(t,T)||x({id:I,config:w.setIn(["searchConfig","dataConfig"],t),useUtilities:j(null==_?void 0:_.useUtility,null===(i=null==t?void 0:t.map((e=>e.useUtility)))||void 0===i?void 0:i.asMutable())})}}),(0,e.jsx)(i.SearchGeneralSetting,{id:I,hint:null==M?void 0:M.hint,onSettingChange:e=>{"string"==typeof e&&e!==(null==M?void 0:M.hint)&&x({id:I,config:w.setIn(["searchConfig","generalConfig"],{hint:e})})}}),(0,e.jsx)(i.SearchSuggestionSetting,{id:I,settingConfig:R,onSettingChange:t=>{e.lodash.isDeepEqual(t,R)||x({id:I,config:w.setIn(["searchConfig","suggestionConfig"],t)})},hideRecentSearchSetting:!0}))):(0,e.jsx)("div",{className:"d-flex justify-content-center align-items-center placeholder-container"},(0,e.jsx)("div",{className:"text-center"},(0,e.jsx)(a,{size:48,className:"d-inline-block placeholder-icon mb-2"}),(0,e.jsx)("p",{className:"placeholder-hint"},C("selectMapHint")))))},b=e.css`
.route-url-input{
  min-height: ${e.polished.rem(100)}
}
.example-url{
  font-size: ${e.polished.rem(12)};
  color: var(--dark-500);
}
.warning-icon{
  color: var(--danger-500);
}
.warning-hint{
  width: calc(100% - 20px);
  margin: 0 4px;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--danger-500);
}
.placeholder-container{
  height: calc(100% - 100px);
  .placeholder-hint{
    font-size: ${e.polished.rem(14)};
    font-weight: 500;
    color: var(--dark-500);
    max-width: ${e.polished.rem(160)};
  }
  .placeholder-icon{
    color: var(--dark-200);
  }
}
.search-settings{
  >div>div {
    padding-left: 0 !important;
    padding-right: 0 !important;
    padding-top: 0 !important;
    border: 0 !important;
  }
}
`;function j(e,t){return[e].concat(t).filter((e=>!!e))}function I(e){r.p=e}})(),l})())}}}));